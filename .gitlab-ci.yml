image: node:latest

stages:
  - deploy

pages:
  stage: deploy
  script:
    - npm run dev
    - npm run web:deploy
    - touch web/out/.nojekyll
    - mkdir web/out/.well-known
    - mkdir web/out/.well-known/acme-challenge
    - touch web/out/.well-known/acme-challenge/6tkGvXq6gq_FhXtqDmX54bd6np9YIRNPJUQ3mqX-JFE
    - echo "6tkGvXq6gq_FhXtqDmX54bd6np9YIRNPJUQ3mqX-JFE.JEALJefL6MoF5ej-xvHYsftlxaT5ZWqj_BoLUBCmXOg" >> web/out/.well-known/acme-challenge/6tkGvXq6gq_FhXtqDmX54bd6np9YIRNPJUQ3mqX-JFE
    - touch web/out/.well-known/acme-challenge/56-6-30jDJcw1fGlD_LyAVlY3WQB2hy-W_3n_peFM-A
    - echo "56-6-30jDJcw1fGlD_LyAVlY3WQB2hy-W_3n_peFM-A.JEALJefL6MoF5ej-xvHYsftlxaT5ZWqj_BoLUBCmXOg" >> web/out/.well-known/acme-challenge/56-6-30jDJcw1fGlD_LyAVlY3WQB2hy-W_3n_peFM-A
    - ls web/out
    - mv web/out public
  artifacts:
    paths:
      - public
  only:
    - master
