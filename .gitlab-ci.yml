image: node:latest

stages:
  - deploy

pages:
  stage: deploy
  script:
    - npm run dev
    - npm run web:deploy
    - touch web/out/.nojekyll
    - mkdir web/out/.well-known
    - mkdir web/out/.well-known/acme-challenge
    - touch web/out/.well-known/acme-challenge/cKlZBSy1pfhpkLwt9OmKKosBljCxcXMci4fwbXHiDOo
    - echo "cKlZBSy1pfhpkLwt9OmKKosBljCxcXMci4fwbXHiDOo.JEALJefL6MoF5ej-xvHYsftlxaT5ZWqj_BoLUBCmXOg" >> web/out/.well-known/acme-challenge/cKlZBSy1pfhpkLwt9OmKKosBljCxcXMci4fwbXHiDOo
    - ls web/out
    - mv web/out public
  artifacts:
    paths:
      - public
  only:
    - master
